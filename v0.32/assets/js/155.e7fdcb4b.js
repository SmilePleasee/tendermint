(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{374:function(e,t,n){"use strict";n.r(t);var a=n(1),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"using-tendermint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-tendermint"}}),e._v(" Using Tendermint")]),e._v(" "),n("p",[e._v("This is a guide to using the "),n("code",[e._v("tendermint")]),e._v(" program from the command line.\nIt assumes only that you have the "),n("code",[e._v("tendermint")]),e._v(" binary installed and have\nsome rudimentary idea of what Tendermint and ABCI are.")]),e._v(" "),n("p",[e._v("You can see the help menu with "),n("code",[e._v("tendermint --help")]),e._v(", and the version\nnumber with "),n("code",[e._v("tendermint version")]),e._v(".")]),e._v(" "),n("h2",{attrs:{id:"directory-root"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#directory-root"}}),e._v(" Directory Root")]),e._v(" "),n("p",[e._v("The default directory for blockchain data is "),n("code",[e._v("~/.tendermint")]),e._v(". Override\nthis by setting the "),n("code",[e._v("TMHOME")]),e._v(" environment variable.")]),e._v(" "),n("h2",{attrs:{id:"initialize"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#initialize"}}),e._v(" Initialize")]),e._v(" "),n("p",[e._v("Initialize the root directory by running:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint init\n")])])]),n("p",[e._v("This will create a new private key ("),n("code",[e._v("priv_validator_key.json")]),e._v("), and a\ngenesis file ("),n("code",[e._v("genesis.json")]),e._v(") containing the associated public key, in\n"),n("code",[e._v("$TMHOME/config")]),e._v(". This is all that's necessary to run a local testnet\nwith one validator.")]),e._v(" "),n("p",[e._v("For more elaborate initialization, see the tesnet command:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint testnet --help\n")])])]),n("h3",{attrs:{id:"genesis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#genesis"}}),e._v(" Genesis")]),e._v(" "),n("p",[e._v("The "),n("code",[e._v("genesis.json")]),e._v(" file in "),n("code",[e._v("$TMHOME/config/")]),e._v(" defines the initial\nTendermintCore state upon genesis of the blockchain ("),n("a",{attrs:{href:"https://github.com/tendermint/tendermint/blob/master/types/genesis.go",target:"_blank",rel:"noopener noreferrer"}},[e._v("see\ndefinition"),n("OutboundLink")],1),e._v(").")]),e._v(" "),n("h4",{attrs:{id:"fields"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#fields"}}),e._v(" Fields")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("genesis_time")]),e._v(": Official time of blockchain start.")]),e._v(" "),n("li",[n("code",[e._v("chain_id")]),e._v(": ID of the blockchain. This must be unique for\nevery blockchain. If your testnet blockchains do not have unique\nchain IDs, you will have a bad time. The ChainID must be less than 50 symbols.")]),e._v(" "),n("li",[n("code",[e._v("consensus_params")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("block")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("time_iota_ms")]),e._v(": Minimum time increment between consecutive blocks (in\nmilliseconds). If the block header timestamp is ahead of the system clock,\ndecrease this value.")])])])])]),e._v(" "),n("li",[n("code",[e._v("validators")]),e._v(": List of initial validators. Note this may be overridden entirely by the\napplication, and may be left empty to make explicit that the\napplication will initialize the validator set with ResponseInitChain.\n"),n("ul",[n("li",[n("code",[e._v("pub_key")]),e._v(": The first element specifies the "),n("code",[e._v("pub_key")]),e._v(" type. 1\n== Ed25519. The second element are the pubkey bytes.")]),e._v(" "),n("li",[n("code",[e._v("power")]),e._v(": The validator's voting power.")]),e._v(" "),n("li",[n("code",[e._v("name")]),e._v(": Name of the validator (optional).")])])]),e._v(" "),n("li",[n("code",[e._v("app_hash")]),e._v(": The expected application hash (as returned by the\n"),n("code",[e._v("ResponseInfo")]),e._v(" ABCI message) upon genesis. If the app's hash does\nnot match, Tendermint will panic.")]),e._v(" "),n("li",[n("code",[e._v("app_state")]),e._v(": The application state (e.g. initial distribution\nof tokens).")])]),e._v(" "),n("h4",{attrs:{id:"sample-genesis-json"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sample-genesis-json"}}),e._v(" Sample genesis.json")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('{\n  "genesis_time": "2018-11-13T18:11:50.277637Z",\n  "chain_id": "test-chain-s4ui7D",\n  "consensus_params": {\n    "block": {\n      "max_bytes": "22020096",\n      "max_gas": "-1",\n      "time_iota_ms": "1000"\n    },\n    "evidence": {\n      "max_age": "100000"\n    },\n    "validator": {\n      "pub_key_types": [\n        "ed25519"\n      ]\n    }\n  },\n  "validators": [\n    {\n      "address": "39C04A480B54AB258A45355A5E48ADDED9956C65",\n      "pub_key": {\n        "type": "tendermint/PubKeyEd25519",\n        "value": "DMEMMj1+thrkUCGocbvvKzXeaAtRslvX9MWtB+smuIA="\n      },\n      "power": "10",\n      "name": ""\n    }\n  ],\n  "app_hash": ""\n}\n')])])]),n("h2",{attrs:{id:"run"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run"}}),e._v(" Run")]),e._v(" "),n("p",[e._v("To run a Tendermint node, use")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint node\n")])])]),n("p",[e._v("By default, Tendermint will try to connect to an ABCI application on\n"),n("a",{attrs:{href:"127.0.0.1:26658"}},[e._v("127.0.0.1:26658")]),e._v(". If you have the "),n("code",[e._v("kvstore")]),e._v(" ABCI app\ninstalled, run it in another window. If you don't, kill Tendermint and\nrun an in-process version of the "),n("code",[e._v("kvstore")]),e._v(" app:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint node --proxy_app=kvstore\n")])])]),n("p",[e._v("After a few seconds you should see blocks start streaming in. Note that\nblocks are produced regularly, even if there are no transactions. See\n"),n("em",[e._v("No Empty Blocks")]),e._v(", below, to modify this setting.")]),e._v(" "),n("p",[e._v("Tendermint supports in-process versions of the "),n("code",[e._v("counter")]),e._v(", "),n("code",[e._v("kvstore")]),e._v(" and\n"),n("code",[e._v("noop")]),e._v(" apps that ship as examples with "),n("code",[e._v("abci-cli")]),e._v(". It's easy to compile\nyour own app in-process with Tendermint if it's written in Go. If your\napp is not written in Go, simply run it in another process, and use the\n"),n("code",[e._v("--proxy_app")]),e._v(" flag to specify the address of the socket it is listening\non, for instance:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint node --proxy_app=/var/run/abci.sock\n")])])]),n("h2",{attrs:{id:"transactions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#transactions"}}),e._v(" Transactions")]),e._v(" "),n("p",[e._v("To send a transaction, use "),n("code",[e._v("curl")]),e._v(" to make requests to the Tendermint RPC\nserver, for example:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('curl http://localhost:26657/broadcast_tx_commit?tx=\\"abcd\\"\n')])])]),n("p",[e._v("We can see the chain's status at the "),n("code",[e._v("/status")]),e._v(" end-point:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("curl http://localhost:26657/status | json_pp\n")])])]),n("p",[e._v("and the "),n("code",[e._v("latest_app_hash")]),e._v(" in particular:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("curl http://localhost:26657/status | json_pp | grep latest_app_hash\n")])])]),n("p",[e._v("Visit http://localhost:26657 in your browser to see the list of other\nendpoints. Some take no arguments (like "),n("code",[e._v("/status")]),e._v("), while others specify\nthe argument name and use "),n("code",[e._v("_")]),e._v(" as a placeholder.")]),e._v(" "),n("p",[e._v("::: tip\nFind the RPC Documentation "),n("a",{attrs:{href:"https://tendermint.com/rpc/",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),n("OutboundLink")],1),e._v("\n:::")]),e._v(" "),n("h3",{attrs:{id:"formatting"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#formatting"}}),e._v(" Formatting")]),e._v(" "),n("p",[e._v("The following nuances when sending/formatting transactions should be\ntaken into account:")]),e._v(" "),n("p",[e._v("With "),n("code",[e._v("GET")]),e._v(":")]),e._v(" "),n("p",[e._v("To send a UTF8 string byte array, quote the value of the tx pramater:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("curl 'http://localhost:26657/broadcast_tx_commit?tx=\"hello\"'\n")])])]),n("p",[e._v('which sends a 5 byte transaction: "h e l l o" [68 65 6c 6c 6f].')]),e._v(" "),n("p",[e._v("Note the URL must be wrapped with single quoes, else bash will ignore\nthe double quotes. To avoid the single quotes, escape the double quotes:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('curl http://localhost:26657/broadcast_tx_commit?tx=\\"hello\\"\n')])])]),n("p",[e._v("Using a special character:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("curl 'http://localhost:26657/broadcast_tx_commit?tx=\"â‚¬5\"'\n")])])]),n("p",[e._v('sends a 4 byte transaction: "â‚¬5" (UTF8) [e2 82 ac 35].')]),e._v(" "),n("p",[e._v("To send as raw hex, omit quotes AND prefix the hex string with "),n("code",[e._v("0x")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("curl http://localhost:26657/broadcast_tx_commit?tx=0x01020304\n")])])]),n("p",[e._v("which sends a 4 byte transaction: [01 02 03 04].")]),e._v(" "),n("p",[e._v("With "),n("code",[e._v("POST")]),e._v(" (using "),n("code",[e._v("json")]),e._v("), the raw hex must be "),n("code",[e._v("base64")]),e._v(" encoded:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('curl --data-binary \'{"jsonrpc":"2.0","id":"anything","method":"broadcast_tx_commit","params": {"tx": "AQIDBA=="}}\' -H \'content-type:text/plain;\' http://localhost:26657\n')])])]),n("p",[e._v("which sends the same 4 byte transaction: [01 02 03 04].")]),e._v(" "),n("p",[e._v("Note that raw hex cannot be used in "),n("code",[e._v("POST")]),e._v(" transactions.")]),e._v(" "),n("h2",{attrs:{id:"reset"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#reset"}}),e._v(" Reset")]),e._v(" "),n("p",[e._v("::: warning\n"),n("strong",[e._v("UNSAFE")]),e._v(" Only do this in development and only if you can\nafford to lose all blockchain data!\n:::")]),e._v(" "),n("p",[e._v("To reset a blockchain, stop the node and run:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint unsafe_reset_all\n")])])]),n("p",[e._v("This command will remove the data directory and reset private validator and\naddress book files.")]),e._v(" "),n("h2",{attrs:{id:"configuration"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}}),e._v(" Configuration")]),e._v(" "),n("p",[e._v("Tendermint uses a "),n("code",[e._v("config.toml")]),e._v(" for configuration. For details, see "),n("router-link",{attrs:{to:"/tendermint-core/configuration.html"}},[e._v("the\nconfig specification")]),e._v(".")],1),e._v(" "),n("p",[e._v("Notable options include the socket address of the application\n("),n("code",[e._v("proxy_app")]),e._v("), the listening address of the Tendermint peer\n("),n("code",[e._v("p2p.laddr")]),e._v("), and the listening address of the RPC server\n("),n("code",[e._v("rpc.laddr")]),e._v(").")]),e._v(" "),n("p",[e._v("Some fields from the config file can be overwritten with flags.")]),e._v(" "),n("h2",{attrs:{id:"no-empty-blocks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#no-empty-blocks"}}),e._v(" No Empty Blocks")]),e._v(" "),n("p",[e._v("While the default behaviour of "),n("code",[e._v("tendermint")]),e._v(" is still to create blocks\napproximately once per second, it is possible to disable empty blocks or\nset a block creation interval. In the former case, blocks will be\ncreated when there are new transactions or when the AppHash changes.")]),e._v(" "),n("p",[e._v("To configure Tendermint to not produce empty blocks unless there are\ntransactions or the app hash changes, run Tendermint with this\nadditional flag:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint node --consensus.create_empty_blocks=false\n")])])]),n("p",[e._v("or set the configuration via the "),n("code",[e._v("config.toml")]),e._v(" file:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("[consensus]\ncreate_empty_blocks = false\n")])])]),n("p",[e._v("Remember: because the default is to "),n("em",[e._v("create empty blocks")]),e._v(", avoiding\nempty blocks requires the config option to be set to "),n("code",[e._v("false")]),e._v(".")]),e._v(" "),n("p",[e._v("The block interval setting allows for a delay (in seconds) between the\ncreation of each new empty block. It is set via the "),n("code",[e._v("config.toml")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("[consensus]\ncreate_empty_blocks_interval = 5\n")])])]),n("p",[e._v("With this setting, empty blocks will be produced every 5s if no block\nhas been produced otherwise, regardless of the value of\n"),n("code",[e._v("create_empty_blocks")]),e._v(".")]),e._v(" "),n("h2",{attrs:{id:"broadcast-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#broadcast-api"}}),e._v(" Broadcast API")]),e._v(" "),n("p",[e._v("Earlier, we used the "),n("code",[e._v("broadcast_tx_commit")]),e._v(" endpoint to send a\ntransaction. When a transaction is sent to a Tendermint node, it will\nrun via "),n("code",[e._v("CheckTx")]),e._v(" against the application. If it passes "),n("code",[e._v("CheckTx")]),e._v(", it\nwill be included in the mempool, broadcasted to other peers, and\neventually included in a block.")]),e._v(" "),n("p",[e._v("Since there are multiple phases to processing a transaction, we offer\nmultiple endpoints to broadcast a transaction:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("/broadcast_tx_async\n/broadcast_tx_sync\n/broadcast_tx_commit\n")])])]),n("p",[e._v("These correspond to no-processing, processing through the mempool, and\nprocessing through a block, respectively. That is, "),n("code",[e._v("broadcast_tx_async")]),e._v(",\nwill return right away without waiting to hear if the transaction is\neven valid, while "),n("code",[e._v("broadcast_tx_sync")]),e._v(" will return with the result of\nrunning the transaction through "),n("code",[e._v("CheckTx")]),e._v(". Using "),n("code",[e._v("broadcast_tx_commit")]),e._v("\nwill wait until the transaction is committed in a block or until some\ntimeout is reached, but will return right away if the transaction does\nnot pass "),n("code",[e._v("CheckTx")]),e._v(". The return value for "),n("code",[e._v("broadcast_tx_commit")]),e._v(" includes\ntwo fields, "),n("code",[e._v("check_tx")]),e._v(" and "),n("code",[e._v("deliver_tx")]),e._v(", pertaining to the result of\nrunning the transaction through those ABCI messages.")]),e._v(" "),n("p",[e._v("The benefit of using "),n("code",[e._v("broadcast_tx_commit")]),e._v(" is that the request returns\nafter the transaction is committed (i.e. included in a block), but that\ncan take on the order of a second. For a quick result, use\n"),n("code",[e._v("broadcast_tx_sync")]),e._v(", but the transaction will not be committed until\nlater, and by that point its effect on the state may change.")]),e._v(" "),n("p",[e._v("Note the mempool does not provide strong guarantees - just because a tx passed\nCheckTx (ie. was accepted into the mempool), doesn't mean it will be committed,\nas nodes with the tx in their mempool may crash before they get to propose.\nFor more information, see the "),n("router-link",{attrs:{to:"/tendermint-core/running-in-production.html#mempool-wal"}},[e._v("mempool\nwrite-ahead-log")])],1),e._v(" "),n("h2",{attrs:{id:"tendermint-networks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tendermint-networks"}}),e._v(" Tendermint Networks")]),e._v(" "),n("p",[e._v("When "),n("code",[e._v("tendermint init")]),e._v(" is run, both a "),n("code",[e._v("genesis.json")]),e._v(" and\n"),n("code",[e._v("priv_validator_key.json")]),e._v(" are created in "),n("code",[e._v("~/.tendermint/config")]),e._v(". The\n"),n("code",[e._v("genesis.json")]),e._v(" might look like:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('{\n  "validators" : [\n    {\n      "pub_key" : {\n        "value" : "h3hk+QE8c6QLTySp8TcfzclJw/BG79ziGB/pIA+DfPE=",\n        "type" : "tendermint/PubKeyEd25519"\n      },\n      "power" : 10,\n      "name" : ""\n    }\n  ],\n  "app_hash" : "",\n  "chain_id" : "test-chain-rDlYSN",\n  "genesis_time" : "0001-01-01T00:00:00Z"\n}\n')])])]),n("p",[e._v("And the "),n("code",[e._v("priv_validator_key.json")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('{\n  "last_step" : 0,\n  "last_round" : "0",\n  "address" : "B788DEDE4F50AD8BC9462DE76741CCAFF87D51E2",\n  "pub_key" : {\n    "value" : "h3hk+QE8c6QLTySp8TcfzclJw/BG79ziGB/pIA+DfPE=",\n    "type" : "tendermint/PubKeyEd25519"\n  },\n  "last_height" : "0",\n  "priv_key" : {\n    "value" : "JPivl82x+LfVkp8i3ztoTjY6c6GJ4pBxQexErOCyhwqHeGT5ATxzpAtPJKnxNx/NyUnD8Ebv3OIYH+kgD4N88Q==",\n    "type" : "tendermint/PrivKeyEd25519"\n  }\n}\n')])])]),n("p",[e._v("The "),n("code",[e._v("priv_validator_key.json")]),e._v(" actually contains a private key, and should\nthus be kept absolutely secret; for now we work with the plain text.\nNote the "),n("code",[e._v("last_")]),e._v(" fields, which are used to prevent us from signing\nconflicting messages.")]),e._v(" "),n("p",[e._v("Note also that the "),n("code",[e._v("pub_key")]),e._v(" (the public key) in the\n"),n("code",[e._v("priv_validator_key.json")]),e._v(" is also present in the "),n("code",[e._v("genesis.json")]),e._v(".")]),e._v(" "),n("p",[e._v("The genesis file contains the list of public keys which may participate\nin the consensus, and their corresponding voting power. Greater than 2/3\nof the voting power must be active (i.e. the corresponding private keys\nmust be producing signatures) for the consensus to make progress. In our\ncase, the genesis file contains the public key of our\n"),n("code",[e._v("priv_validator_key.json")]),e._v(", so a Tendermint node started with the default\nroot directory will be able to make progress. Voting power uses an int64\nbut must be positive, thus the range is: 0 through 9223372036854775807.\nBecause of how the current proposer selection algorithm works, we do not\nrecommend having voting powers greater than 10^12 (ie. 1 trillion).")]),e._v(" "),n("p",[e._v("If we want to add more nodes to the network, we have two choices: we can\nadd a new validator node, who will also participate in the consensus by\nproposing blocks and voting on them, or we can add a new non-validator\nnode, who will not participate directly, but will verify and keep up\nwith the consensus protocol.")]),e._v(" "),n("h3",{attrs:{id:"peers"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#peers"}}),e._v(" Peers")]),e._v(" "),n("h4",{attrs:{id:"seed"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#seed"}}),e._v(" Seed")]),e._v(" "),n("p",[e._v("A seed node is a node who relays the addresses of other peers which they know\nof. These nodes constantly crawl the network to try to get more peers. The\naddresses which the seed node relays get saved into a local address book. Once\nthese are in the address book, you will connect to those addresses directly.\nBasically the seed nodes job is just to relay everyones addresses. You won't\nconnect to seed nodes once you have received enough addresses, so typically you\nonly need them on the first start. The seed node will immediately disconnect\nfrom you after sending you some addresses.")]),e._v(" "),n("h4",{attrs:{id:"persistent-peer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#persistent-peer"}}),e._v(" Persistent Peer")]),e._v(" "),n("p",[e._v("Persistent peers are people you want to be constantly connected with. If you\ndisconnect you will try to connect directly back to them as opposed to using\nanother address from the address book. On restarts you will always try to\nconnect to these peers regardless of the size of your address book.")]),e._v(" "),n("p",[e._v("All peers relay peers they know of by default. This is called the peer exchange\nprotocol (PeX). With PeX, peers will be gossipping about known peers and forming\na network, storing peer addresses in the addrbook. Because of this, you don't\nhave to use a seed node if you have a live persistent peer.")]),e._v(" "),n("h4",{attrs:{id:"connecting-to-peers"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#connecting-to-peers"}}),e._v(" Connecting to Peers")]),e._v(" "),n("p",[e._v("To connect to peers on start-up, specify them in the\n"),n("code",[e._v("$TMHOME/config/config.toml")]),e._v(" or on the command line. Use "),n("code",[e._v("seeds")]),e._v(" to\nspecify seed nodes, and\n"),n("code",[e._v("persistent_peers")]),e._v(" to specify peers that your node will maintain\npersistent connections with.")]),e._v(" "),n("p",[e._v("For example,")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('tendermint node --p2p.seeds "f9baeaa15fedf5e1ef7448dd60f46c01f1a9e9c4@1.2.3.4:26656,0491d373a8e0fcf1023aaf18c51d6a1d0d4f31bd@5.6.7.8:26656"\n')])])]),n("p",[e._v("Alternatively, you can use the "),n("code",[e._v("/dial_seeds")]),e._v(" endpoint of the RPC to\nspecify seeds for a running node to connect to:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('curl \'localhost:26657/dial_seeds?seeds=\\["f9baeaa15fedf5e1ef7448dd60f46c01f1a9e9c4@1.2.3.4:26656","0491d373a8e0fcf1023aaf18c51d6a1d0d4f31bd@5.6.7.8:26656"\\]\'\n')])])]),n("p",[e._v("Note, with PeX enabled, you\nshould not need seeds after the first start.")]),e._v(" "),n("p",[e._v("If you want Tendermint to connect to specific set of addresses and\nmaintain a persistent connection with each, you can use the\n"),n("code",[e._v("--p2p.persistent_peers")]),e._v(" flag or the corresponding setting in the\n"),n("code",[e._v("config.toml")]),e._v(" or the "),n("code",[e._v("/dial_peers")]),e._v(" RPC endpoint to do it without\nstopping Tendermint core instance.")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('tendermint node --p2p.persistent_peers "429fcf25974313b95673f58d77eacdd434402665@10.11.12.13:26656,96663a3dd0d7b9d17d4c8211b191af259621c693@10.11.12.14:26656"\n\ncurl \'localhost:26657/dial_peers?persistent=true&peers=\\["429fcf25974313b95673f58d77eacdd434402665@10.11.12.13:26656","96663a3dd0d7b9d17d4c8211b191af259621c693@10.11.12.14:26656"\\]\'\n')])])]),n("h3",{attrs:{id:"adding-a-non-validator"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#adding-a-non-validator"}}),e._v(" Adding a Non-Validator")]),e._v(" "),n("p",[e._v("Adding a non-validator is simple. Just copy the original "),n("code",[e._v("genesis.json")]),e._v("\nto "),n("code",[e._v("~/.tendermint/config")]),e._v(" on the new machine and start the node,\nspecifying seeds or persistent peers as necessary. If no seeds or\npersistent peers are specified, the node won't make any blocks, because\nit's not a validator, and it won't hear about any blocks, because it's\nnot connected to the other peer.")]),e._v(" "),n("h3",{attrs:{id:"adding-a-validator"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#adding-a-validator"}}),e._v(" Adding a Validator")]),e._v(" "),n("p",[e._v("The easiest way to add new validators is to do it in the "),n("code",[e._v("genesis.json")]),e._v(",\nbefore starting the network. For instance, we could make a new\n"),n("code",[e._v("priv_validator_key.json")]),e._v(", and copy it's "),n("code",[e._v("pub_key")]),e._v(" into the above genesis.")]),e._v(" "),n("p",[e._v("We can generate a new "),n("code",[e._v("priv_validator_key.json")]),e._v(" with the command:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tendermint gen_validator\n")])])]),n("p",[e._v("Now we can update our genesis file. For instance, if the new\n"),n("code",[e._v("priv_validator_key.json")]),e._v(" looks like:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('{\n  "address" : "5AF49D2A2D4F5AD4C7C8C4CC2FB020131E9C4902",\n  "pub_key" : {\n    "value" : "l9X9+fjkeBzDfPGbUM7AMIRE6uJN78zN5+lk5OYotek=",\n    "type" : "tendermint/PubKeyEd25519"\n  },\n  "priv_key" : {\n    "value" : "EDJY9W6zlAw+su6ITgTKg2nTZcHAH1NMTW5iwlgmNDuX1f35+OR4HMN88ZtQzsAwhETq4k3vzM3n6WTk5ii16Q==",\n    "type" : "tendermint/PrivKeyEd25519"\n  },\n  "last_step" : 0,\n  "last_round" : "0",\n  "last_height" : "0"\n}\n')])])]),n("p",[e._v("then the new "),n("code",[e._v("genesis.json")]),e._v(" will be:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('{\n  "validators" : [\n    {\n      "pub_key" : {\n        "value" : "h3hk+QE8c6QLTySp8TcfzclJw/BG79ziGB/pIA+DfPE=",\n        "type" : "tendermint/PubKeyEd25519"\n      },\n      "power" : 10,\n      "name" : ""\n    },\n    {\n      "pub_key" : {\n        "value" : "l9X9+fjkeBzDfPGbUM7AMIRE6uJN78zN5+lk5OYotek=",\n        "type" : "tendermint/PubKeyEd25519"\n      },\n      "power" : 10,\n      "name" : ""\n    }\n  ],\n  "app_hash" : "",\n  "chain_id" : "test-chain-rDlYSN",\n  "genesis_time" : "0001-01-01T00:00:00Z"\n}\n')])])]),n("p",[e._v("Update the "),n("code",[e._v("genesis.json")]),e._v(" in "),n("code",[e._v("~/.tendermint/config")]),e._v(". Copy the genesis\nfile and the new "),n("code",[e._v("priv_validator_key.json")]),e._v(" to the "),n("code",[e._v("~/.tendermint/config")]),e._v(" on\na new machine.")]),e._v(" "),n("p",[e._v("Now run "),n("code",[e._v("tendermint node")]),e._v(" on both machines, and use either\n"),n("code",[e._v("--p2p.persistent_peers")]),e._v(" or the "),n("code",[e._v("/dial_peers")]),e._v(" to get them to peer up.\nThey should start making blocks, and will only continue to do so as long\nas both of them are online.")]),e._v(" "),n("p",[e._v("To make a Tendermint network that can tolerate one of the validators\nfailing, you need at least four validator nodes (e.g., 2/3).")]),e._v(" "),n("p",[e._v("Updating validators in a live network is supported but must be\nexplicitly programmed by the application developer. See the "),n("router-link",{attrs:{to:"/app-dev/app-development.html"}},[e._v("application\ndevelopers guide")]),e._v(" for more details.")],1),e._v(" "),n("h3",{attrs:{id:"local-network"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#local-network"}}),e._v(" Local Network")]),e._v(" "),n("p",[e._v("To run a network locally, say on a single machine, you must change the "),n("code",[e._v("_laddr")]),e._v("\nfields in the "),n("code",[e._v("config.toml")]),e._v(" (or using the flags) so that the listening\naddresses of the various sockets don't conflict. Additionally, you must set\n"),n("code",[e._v("addr_book_strict=false")]),e._v(" in the "),n("code",[e._v("config.toml")]),e._v(", otherwise Tendermint's p2p\nlibrary will deny making connections to peers with the same IP address.")]),e._v(" "),n("h3",{attrs:{id:"upgrading"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#upgrading"}}),e._v(" Upgrading")]),e._v(" "),n("p",[e._v("See the\n"),n("a",{attrs:{href:"https://github.com/tendermint/tendermint/blob/master/UPGRADING.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("UPGRADING.md"),n("OutboundLink")],1),e._v("\nguide. You may need to reset your chain between major breaking releases.\nAlthough, we expect Tendermint to have fewer breaking releases in the future\n(especially after 1.0 release).")])])}),[],!1,null,null,null);t.default=s.exports}}]);